
<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		
		<title>Kwik Print Main Page</title>
		
		<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <link rel='stylesheet' href='./css/jquery.mobile-1.4.5.css'  type="text/css" />
		<script src="./js/jquery.min.js" type="text/javascript"></script>
		<script src="./js/jquery.mobile-1.4.5.min.js" type="text/javascript"></script>

		<script src="https://www.gstatic.com/firebasejs/3.6.9/firebase.js"></script>

		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAldk41ArYQ0WfSnox09Qn9_f4dwMb8OI0"></script>
		<script type="text/javascript" src="js/jquery.googlemap.js"></script>
		
	<script>

	// Initialize Firebase
	var config = {
		apiKey: "AIzaSyCjggsSTMdZQdrtmmz1VZHqBQlpK2xL_WE",
		authDomain: "kwikprint-347d2.firebaseapp.com",
		databaseURL: "https://kwikprint-347d2.firebaseio.com",
		storageBucket: "kwikprint-347d2.appspot.com",
		messagingSenderId: "223654306675"
	};
	firebase.initializeApp(config);

	
/*
 * Google Maps documentation: http://code.google.com/apis/maps/documentation/javascript/basics.html
 * Geolocation documentation: http://dev.w3.org/geo/api/spec-source.html
 */
 
 /*
$( document ).on( "pageinit", "#map-page", function() {

    var defaultLatLng = new google.maps.LatLng(34.0983425, -118.3267434);  // Default to Hollywood, CA when no geolocation support	
    if ( navigator.geolocation ) {
		function success(pos) {		
            // Location found, show map with these coordinates
            drawMap(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude));
alert("hello:" + defaultLatLng + ", " + pos);	
        }
        function fail(error) {
            drawMap(defaultLatLng);  // Failed to find location, show default map
        }
        // Find the users current position.  Cache the location for 5 minutes, timeout after 6 seconds
        navigator.geolocation.getCurrentPosition(success, fail, {maximumAge: 500000, enableHighAccuracy:true, timeout: 6000});
    } else {
        drawMap(defaultLatLng);  // No geolocation support, show default map
    }
	
    function drawMap(latlng) {
        var myOptions = {
            zoom: 10,
            center: latlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        var map = new google.maps.Map(document.getElementById("map-canvas"), myOptions);
        // Add an overlay to the map of current lat/lng
        var marker = new google.maps.Marker({
            position: latlng,
            map: map,
            title: "Greetings!"
        });
    }
});
*/ 

function contentHeight() {
    var screen = $.mobile.getScreenHeight(),
        header = $(".ui-header").hasClass("ui-header-fixed") ? $(".ui-header").outerHeight() - 1 : $(".ui-header").outerHeight(),
        footer = $(".ui-footer").hasClass("ui-footer-fixed") ? $(".ui-footer").outerHeight() - 1 : $(".ui-footer").outerHeight(),
        ////* content div has padding of 1em = 16px (32px top+bottom). This step
   //	can be skipped by subtracting 32px from content var directly. */
        contentCurrent = $(".ui-content").outerHeight() - $(".ui-content").height(),
        content = screen - header - footer - contentCurrent;
    ////* apply result */
    $(".ui-content").height(content);

	//alert("screen : " +  $(window).height() );
	//alert("content outer height:" + $(".ui-content").outerHeight() + ", height:" +  $(".ui-content").height());
}

$(document).on("pagecontainertransition", contentHeight);
$(window).on("throttledresize orientationchange", contentHeight);
//////// google map 

function initialize() { 

	var mapOptions = {
    panControl: true, //要不要出現可以上下左右移動的面板，如圖1
    zoomControl: true, //要不要出現可以放大縮小的面板，如圖3
    mapTypeControl: true, //切換地圖檢視類型的面板，如圖4
    scaleControl: true, //比例尺資訊，如圖5
    streetViewControl: true,  //顯示街景服務的面板，如圖2
    overviewMapControl: true, //總覽圖的面板，在右下力有個開合的圖示，如圖6
    center: new google.maps.LatLng(25.048215, 121.517123), //台北車站的經度,緯度
    zoom: 17 //縮放的大小，0-18，0最小，18最大
  };
   
	var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
	alert("map: " + map);

}


var Markers = [];

function addMarker(map,location,title,content) {
    var marker = new google.maps.Marker({
        position: location, 
        map: map,
        title: title,
        icon: {
            path: google.maps.SymbolPath.CIRCLE,
            fillColor: '#FFFFFF',
            fillOpacity: 1,
            strokeColor: '#FFFF00',
            strokeWeight: 3,
            scale: 6
        }
    });
    google.maps.event.addListener(marker, 'mouseover', function(e) {
        this.setIcon({
            path: google.maps.SymbolPath.CIRCLE,
            fillColor: '#FFFFFF',
            fillOpacity: 1,
            strokeColor: '#FF0000',
            strokeWeight: 3,
            scale: 6
        });
        this.setZIndex(1000);
    });
    google.maps.event.addListener(marker, 'mouseout', function(e) {
        this.setIcon({
            path: google.maps.SymbolPath.CIRCLE,
            fillColor: '#FFFFFF',
            fillOpacity: 1,
            strokeColor: '#FFFF00',
            strokeWeight: 3,
            scale: 6
        });
        this.setZIndex(1);
    });
    var infowindow = new google.maps.InfoWindow({
        content: '<div style="overflow:hidden;">' + content + '</div>',
        maxWidth: 350
    });
    google.maps.event.addListener(marker, 'click', function() {
        infowindow.open(map,marker);
    });
    Markers.push(marker);
}
/*
setInterval(function(){
    if (marker.getVisible()) {
        marker.setVisible(false);
    } else {
        marker.setVisible(true);
    }
}, 1000);

*/

////
	</script>
		
	</head>
	<body>

		<div data-role="page" class="ui-responsive-panel" id="map-page">

			<div data-role="header" data-theme="a" class="ui-header">
				<h1>Kwik Print</h1>
				<a href="#nav-panel" data-icon="bars" data-iconpos="notext">Menu</a>
				<a href="#add-form" data-icon="plus" data-iconpos="notext">Add</a>
			</div><!-- /header -->
				 


			<div data-role="footer" class="jqm-footer" data-position="fixed">
				<p class="jqm-version"></p>
				<p>&copy; 2010, 2013 jQuery Foundation and other contributors</p>
			</div><!-- /jqm-footer -->
			
			
			<style>
				.nav-search .ui-btn-up-a {
					background-image:none;
					background-color:#333333;
				}
				.nav-search .ui-btn-inner {
					border-top: 1px solid #888;
					border-color: rgba(255, 255, 255, .1);
				}
				
	
				.scrollable {
					overflow-y: scroll;
					-webkit-overflow-scrolling: touch;
				}
			
			map-canvas { width: 400px; height: 600px; padding: 0; border-style:solid; border-width:5px;}

            </style>
				<div>
					<button onclick="addMarker()">Mark</button>
				</div>
				<div data-role="content" id="map-canvas" class="ui-content">
					map
				</div>
	
		</div><!-- /page -->
	</body>
</html>
