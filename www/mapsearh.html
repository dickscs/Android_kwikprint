<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		
		<title>Kwik Print Search Map</title>
		
		<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
        <link rel='stylesheet' href='./css/jquery.mobile-1.4.5.css'  type="text/css" />
		<script src="./js/jquery.min.js" type="text/javascript"></script>
		<script src="./js/jquery.mobile-1.4.5.min.js" type="text/javascript"></script>

		<script src="https://www.gstatic.com/firebasejs/3.6.9/firebase.js"></script>
	
		<script type="text/javascript" src="cordova.js"></script>
		<script type="text/javascript" src="js/kwikinit.js"></script>
		
		<!--  Google Map Javascript API -->
		<!-- script src="https://maps.googleapis.com/maps/api/js?v=3.exp&language=en"></script -->
		<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAldk41ArYQ0WfSnox09Qn9_f4dwMb8OI0"></script>
	
	<script>
		
	function logout() {
		firebase.auth().signOut().then(function() {
			window.location = "index.html";
		}, function(error) {
			// An error happened 
			alert("Logout Failed");
		});
	}

	</script>

	<script>
	var mapOptions = {
			panControl: true, 
			zoomControl: true, 
			mapTypeControl: false, 
			scaleControl: true, 
			streetViewControl: false,  
			overviewMapControl: false, 
			center: new google.maps.LatLng(52.621124, -1.124762), // 
			zoom: 18, 
			mapTypeId: google.maps.MapTypeId.ROADMAP
	};
	
	function initMap() {

		function success(pos) {
			  drawMap(new google.maps.LatLng(pos.coords.latitude, pos.coords.longitude)); // get current location 
		}
		function error(err) {
			alert("Location Error : " + err.message + "\n\rPlease make sure GPS is turned ON" );
			console.warn(`ERROR(${err.code}): ${err.message}`);
		};
	
		if (navigator.geolocation) {
			navigator.geolocation.getCurrentPosition( success, error, {maximumAge: 500000, enableHighAccuracy:true, timeout: 6000} );
		}
	
	
	}
	
	 function drawMap(latlng) {   
	 
		mapOptions.center = latlng;
        var map = new google.maps.Map(document.getElementById("map-canvas"), mapOptions);
        // Add an overlay to the map of current lat/lng
        var marker = new google.maps.Marker({
            position: latlng,
            map: map,
            title : "My Location",
			//icon : "img/printer-icon2.png"
        });
    }
	
	//$( document ).on( "pageinit", "#map-page", initMap() ) ;
	
	$(document).ready( function() {
 
		if (window.device) {	// Check Phonegap or browser
			document.addEventListener("deviceready", onDeviceReady, false);
		} else {	// For testing in chrome
			onDeviceReady();
		}
	}); 
 
	function onDeviceReady() {
		initMap();
	}
	
	function contentHeight() {
		var screen = $.mobile.getScreenHeight(),
			header = $(".ui-header").hasClass("ui-header-fixed") ? $(".ui-header").outerHeight() - 1 : $(".ui-header").outerHeight(),
			footer = $(".ui-footer").hasClass("ui-footer-fixed") ? $(".ui-footer").outerHeight() - 1 : $(".ui-footer").outerHeight(),
        ////* content div has padding of 1em = 16px (32px top+bottom). This step
		//	can be skipped by subtracting 32px from content var directly. */
        contentCurrent = $(".ui-content").outerHeight() - $(".ui-content").height(),
        content = screen - header - footer - contentCurrent;
    ////* apply result */
		$(".ui-content").height(content);
		
	}

	$(document).on("pagecontainertransition", contentHeight);	
	$(window).on("throttledresize orientationchange", contentHeight);

	</script>
	
	</head>
	<body>
		<div data-role="page" class="ui-responsive-panel">

			<div data-role="header" data-theme="a">
				<h1>Kwik Print</h1>
				<a href="#nav-panel" data-icon="bars" data-iconpos="notext">Menu</a>
				<!-- a href="#add-form" data-icon="plus" data-iconpos="notext">Add</a -->
			</div><!-- /header -->
			<div role="main" class="ui-content" id="map-canvas" >
				Here is the Map Canvas	
			</div>

			<div data-role="footer" class="jqm-footer" data-position="fixed">
				<p class="jqm-version"></p>
				<p>Search Printer</p>
			</div><!-- /jqm-footer -->
			
			
			<style>
				.nav-search .ui-btn-up-a {
					background-image:none;
					background-color:#333333;
				}
				.nav-search .ui-btn-inner {
					border-top: 1px solid #888;
					border-color: rgba(255, 255, 255, .1);
				}
				
				.scrollable {
					overflow-y: scroll;
					-webkit-overflow-scrolling: touch;
				}
		
            </style>

				<div data-role="panel" data-position="left" data-position-fixed="false" data-display="reveal" id="nav-panel" data-theme="a">

					<ul data-role="listview" data-theme="a" data-divider-theme="a" style="margin-top:-16px;" class="nav-search">
						<li data-icon="delete" style="background-color:#111;">
							<a href="#" data-rel="close">Close menu</a>
						</li>
						<li data-filtertext="">
							<a href="#" onclick="window.location='main.html'">Main Page</a>
						</li>
						<li data-filtertext="">
							<a href="#">Set Search Range</a>
						</li>
					</ul>
					<!-- panel content goes here -->
				</div><!-- /panel -->

				<style>
					.userform { padding:.8em 1.2em; }
					.userform h2 { color:#555; margin:0.3em 0 .8em 0; padding-bottom:.5em; border-bottom:1px solid rgba(0,0,0,.1); }
					.userform label { display:block; margin-top:1.2em; }
					.switch .ui-slider-switch { width: 6.5em !important }
					.ui-grid-a { margin-top:1em; padding-top:.8em; margin-top:1.4em; border-top:1px solid rgba(0,0,0,.1); }
                </style>

				<!-- div data-role="panel" data-position="right" data-position-fixed="false" data-display="overlay" id="add-form" data-theme="b">
					<ul data-role="listview" data-theme="a" data-divider-theme="a" style="margin-top:-16px;" class="_nav-search$$">

						<li data-icon="" style="background-color:#111;">
							<a href="#" data-rel="close">...</a>
						</li>
					
						<li data-icon="" style="background-color:#111;">
							<a href="#">User Profile</a>
						</li>
						<li data-icon="" style="background-color:#111;">
							<a href="#">My Printer</a>
						</li>
						<li data-icon="delete" style="background-color:#111;">
							<a href="#" data-rel="logout" onclick="logout();">Logout</a>
						</li>
					</ul>
			
				</div --><!-- /panel -->
				
		</div><!-- /page -->
	
	</body>
</html>
